{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "liquid-glass-button",
  "type": "registry:component",
  "title": "Liquid Glass Button",
  "description": "Button with animated liquid glass shader effect using SVG displacement maps.",
  "files": [
    {
      "path": "registry/new-york/components/liquid-glass-button/liquid-glass-button.tsx",
      "content": "\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { Slot } from \"@radix-ui/react-slot\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst liquidGlassButtonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive relative overflow-hidden\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-transparent/20 backdrop-blur-sm shadow-xs hover:bg-transparent/40\",\r\n        destructive:\r\n          \"bg-transparent hover:bg-white/10 text-white focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40\",\r\n        \"destructive-red\":\r\n          \"bg-red-500 text-white shadow-xs hover:bg-red-600 focus-visible:ring-red-500/20 dark:focus-visible:ring-red-500/40 dark:bg-red-600\",\r\n        outline:\r\n          \"border bg-transparent/20 backdrop-blur-sm shadow-xs hover:bg-transparent/40 hover:text-accent-foreground dark:bg-transparent/30 dark:border-input dark:hover:bg-transparent/50\",\r\n        secondary:\r\n          \"bg-transparent/20 backdrop-blur-sm text-secondary-foreground shadow-xs hover:bg-transparent/40\",\r\n        ghost:\r\n          \"hover:backdrop-blur-sm hover:bg-white/5 hover:text-accent-foreground dark:hover:backdrop-blur-sm dark:hover:bg-black/5\",\r\n        link: \"text-primary underline-offset-4 hover:underline bg-transparent\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\r\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\r\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\r\n        icon: \"size-9\",\r\n        \"icon-sm\": \"size-8\",\r\n        \"icon-lg\": \"size-10\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n);\r\n\r\ninterface LiquidGlassButtonProps\r\n  extends React.ComponentProps<\"button\">,\r\n    VariantProps<typeof liquidGlassButtonVariants> {\r\n  asChild?: boolean;\r\n  distortionStrength?: number;\r\n  borderRadius?: number;\r\n  animationSpeed?: number;\r\n  scale?: number;\r\n  offsetX?: number;\r\n  offsetY?: number;\r\n  rotation?: number;\r\n  worldWidth?: number;\r\n  worldHeight?: number;\r\n  textClassName?: string;\r\n}\r\n\r\n// Utility functions for shader math\r\nfunction smoothStep(a: number, b: number, t: number): number {\r\n  t = Math.max(0, Math.min(1, (t - a) / (b - a)));\r\n  return t * t * (3 - 2 * t);\r\n}\r\n\r\nfunction length(x: number, y: number): number {\r\n  return Math.sqrt(x * x + y * y);\r\n}\r\n\r\nfunction roundedRectSDF(\r\n  x: number,\r\n  y: number,\r\n  width: number,\r\n  height: number,\r\n  radius: number\r\n): number {\r\n  const qx = Math.abs(x) - width + radius;\r\n  const qy = Math.abs(y) - height + radius;\r\n  return (\r\n    Math.min(Math.max(qx, qy), 0) +\r\n    length(Math.max(qx, 0), Math.max(qy, 0)) -\r\n    radius\r\n  );\r\n}\r\n\r\nfunction texture(x: number, y: number): { type: string; x: number; y: number } {\r\n  return { type: \"t\", x, y };\r\n}\r\n\r\nconst LiquidGlassButton = React.forwardRef<\r\n  HTMLButtonElement,\r\n  LiquidGlassButtonProps\r\n>(\r\n  (\r\n    {\r\n      className,\r\n      variant,\r\n      size,\r\n      asChild = false,\r\n      distortionStrength = 0.15,\r\n      borderRadius = 0.6,\r\n      animationSpeed = 1,\r\n      scale = 1,\r\n      offsetX,\r\n      offsetY,\r\n      rotation,\r\n      worldWidth,\r\n      worldHeight,\r\n      textClassName,\r\n      children,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const containerRef = React.useRef<HTMLButtonElement>(null);\r\n    const svgRef = React.useRef<SVGSVGElement>(null);\r\n    const canvasRef = React.useRef<HTMLCanvasElement>(null);\r\n    const animationFrameRef = React.useRef<number | undefined>(undefined);\r\n    const timeRef = React.useRef(0);\r\n    const uniqueIdRef = React.useRef(\r\n      \"liquid-glass-\" + Math.random().toString(36).substr(2, 9)\r\n    );\r\n    const uniqueId = uniqueIdRef.current;\r\n\r\n    const updateShader = React.useCallback(() => {\r\n      const canvas = canvasRef.current;\r\n      const svg = svgRef.current;\r\n      const container = containerRef.current;\r\n\r\n      if (!canvas || !svg || !container) return;\r\n\r\n      const containerRect = container.getBoundingClientRect();\r\n      const width = Math.floor(containerRect.width);\r\n      const height = Math.floor(containerRect.height);\r\n\r\n      if (width === 0 || height === 0) return;\r\n\r\n      const canvasDPI = 2;\r\n      const w = width * canvasDPI;\r\n      const h = height * canvasDPI;\r\n\r\n      canvas.width = w;\r\n      canvas.height = h;\r\n      const context = canvas.getContext(\"2d\");\r\n      if (!context) return;\r\n\r\n      const data = new Uint8ClampedArray(w * h * 4);\r\n      let maxScale = 0;\r\n      const rawValues: number[] = [];\r\n\r\n      for (let i = 0; i < data.length; i += 4) {\r\n        const x = (i / 4) % w;\r\n        const y = Math.floor(i / 4 / w);\r\n        const uv = { x: x / w, y: y / h };\r\n\r\n        // Calculate time-based animation\r\n        const frame = timeRef.current * animationSpeed;\r\n        const ix = uv.x - 0.5;\r\n        const iy = uv.y - 0.5;\r\n\r\n        // Apply rotation if specified\r\n        let rotatedX = ix;\r\n        let rotatedY = iy;\r\n        if (rotation) {\r\n          const rad = (rotation * Math.PI) / 180;\r\n          const cos = Math.cos(rad);\r\n          const sin = Math.sin(rad);\r\n          rotatedX = ix * cos - iy * sin;\r\n          rotatedY = ix * sin + iy * cos;\r\n        }\r\n\r\n        // Apply offset if specified\r\n        const finalX =\r\n          (offsetX !== undefined ? rotatedX + offsetX : rotatedX) * scale;\r\n        const finalY =\r\n          (offsetY !== undefined ? rotatedY + offsetY : rotatedY) * scale;\r\n\r\n        // Calculate world dimensions\r\n        const ww = worldWidth || 0.5;\r\n        const wh = worldHeight || 0.5;\r\n\r\n        const distanceToEdge = roundedRectSDF(\r\n          finalX / ww,\r\n          finalY / wh,\r\n          0.3,\r\n          0.2,\r\n          borderRadius\r\n        );\r\n\r\n        const displacement = smoothStep(\r\n          0.8,\r\n          0,\r\n          distanceToEdge - distortionStrength\r\n        );\r\n        const scaled = smoothStep(0, 1, displacement);\r\n\r\n        const pos = texture(finalX * scaled + 0.5, finalY * scaled + 0.5);\r\n        const dx = pos.x * w - x;\r\n        const dy = pos.y * h - y;\r\n        maxScale = Math.max(maxScale, Math.abs(dx), Math.abs(dy));\r\n        rawValues.push(dx, dy);\r\n      }\r\n\r\n      maxScale *= 0.5;\r\n\r\n      let index = 0;\r\n      for (let i = 0; i < data.length; i += 4) {\r\n        const r = rawValues[index++] / maxScale + 0.5;\r\n        const g = rawValues[index++] / maxScale + 0.5;\r\n        data[i] = r * 255;\r\n        data[i + 1] = g * 255;\r\n        data[i + 2] = 0;\r\n        data[i + 3] = 255;\r\n      }\r\n\r\n      context.putImageData(new ImageData(data, w, h), 0, 0);\r\n\r\n      const feImage = svg.querySelector(`#${uniqueId}_map`);\r\n      const feDisplacementMap = svg.querySelector(\r\n        `#${uniqueId}_filter feDisplacementMap`\r\n      );\r\n\r\n      if (feImage && feDisplacementMap instanceof SVGFEImageElement) {\r\n        feImage.setAttributeNS(\r\n          \"http://www.w3.org/1999/xlink\",\r\n          \"href\",\r\n          canvas.toDataURL()\r\n        );\r\n        if (feDisplacementMap instanceof SVGFEDisplacementMapElement) {\r\n          feDisplacementMap.setAttribute(\r\n            \"scale\",\r\n            (maxScale / canvasDPI).toString()\r\n          );\r\n        }\r\n      }\r\n    }, [\r\n      uniqueId,\r\n      distortionStrength,\r\n      borderRadius,\r\n      animationSpeed,\r\n      scale,\r\n      offsetX,\r\n      offsetY,\r\n      rotation,\r\n      worldWidth,\r\n      worldHeight,\r\n    ]);\r\n\r\n    const animate = React.useCallback(() => {\r\n      timeRef.current += 0.016; // ~60fps\r\n      updateShader();\r\n      animationFrameRef.current = requestAnimationFrame(animate);\r\n    }, [updateShader]);\r\n\r\n    React.useEffect(() => {\r\n      animationFrameRef.current = requestAnimationFrame(animate);\r\n      return () => {\r\n        if (animationFrameRef.current) {\r\n          cancelAnimationFrame(animationFrameRef.current);\r\n        }\r\n      };\r\n    }, [animate]);\r\n\r\n    React.useEffect(() => {\r\n      updateShader();\r\n    }, [updateShader]);\r\n\r\n    const Comp = asChild ? Slot : \"button\";\r\n    \r\n    // Combine refs for containerRef and external ref\r\n    const handleRef = React.useCallback(\r\n      (node: HTMLButtonElement | null) => {\r\n        containerRef.current = node;\r\n        if (typeof ref === \"function\") {\r\n          ref(node);\r\n        } else if (ref) {\r\n          ref.current = node;\r\n        }\r\n      },\r\n      [ref]\r\n    );\r\n\r\n    return (\r\n      <>\r\n        {/* Hidden SVG with filter definition */}\r\n        <svg\r\n          ref={svgRef}\r\n          width=\"0\"\r\n          height=\"0\"\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            pointerEvents: \"none\",\r\n            zIndex: -1,\r\n          }}\r\n        >\r\n          <defs>\r\n            <filter\r\n              id={`${uniqueId}_filter`}\r\n              filterUnits=\"userSpaceOnUse\"\r\n              colorInterpolationFilters=\"sRGB\"\r\n            >\r\n              <feImage id={`${uniqueId}_map`} width=\"100%\" height=\"100%\" />\r\n              <feDisplacementMap\r\n                in=\"SourceGraphic\"\r\n                in2={`${uniqueId}_map`}\r\n                xChannelSelector=\"R\"\r\n                yChannelSelector=\"G\"\r\n                scale=\"0\"\r\n              />\r\n            </filter>\r\n          </defs>\r\n        </svg>\r\n\r\n        {/* Hidden canvas for displacement map */}\r\n        <canvas ref={canvasRef} style={{ display: \"none\" }} />\r\n\r\n        {/* Button with liquid glass effect */}\r\n        <Comp\r\n          ref={asChild ? undefined : handleRef}\r\n          className={cn(\r\n            liquidGlassButtonVariants({ variant, size, className })\r\n          )}\r\n          style={{\r\n            backdropFilter: `url(#${uniqueId}_filter) blur(0.25px) brightness(1.5) saturate(1.1)`,\r\n          }}\r\n          {...props}\r\n        >\r\n          {/* Content */}\r\n          <span\r\n            className={cn(\"relative z-10\", textClassName || \"text-primary\")}\r\n          >\r\n            {children}\r\n          </span>\r\n        </Comp>\r\n      </>\r\n    );\r\n  }\r\n);\r\n\r\nLiquidGlassButton.displayName = \"LiquidGlassButton\";\r\n\r\nexport { LiquidGlassButton, liquidGlassButtonVariants };\r\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/components/liquid-glass-button/demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { LiquidGlassButton } from \"./liquid-glass-button\";\r\n\r\nexport function LiquidGlassButtonDemo() {\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-[200px] p-8\">\r\n      <LiquidGlassButton>Liquid Glass</LiquidGlassButton>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/components/liquid-glass-button/variants-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { LiquidGlassButton } from \"./liquid-glass-button\";\r\n\r\nexport function LiquidGlassVariantsDemo() {\r\n  return (\r\n    <div className=\"flex flex-wrap gap-4 items-center justify-center min-h-[200px] p-8\">\r\n      <LiquidGlassButton variant=\"default\">Default</LiquidGlassButton>\r\n      <LiquidGlassButton variant=\"outline\">Outline</LiquidGlassButton>\r\n      <LiquidGlassButton variant=\"secondary\">Secondary</LiquidGlassButton>\r\n      <LiquidGlassButton variant=\"ghost\">Ghost</LiquidGlassButton>\r\n      <LiquidGlassButton variant=\"destructive\">Destructive</LiquidGlassButton>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/components/liquid-glass-button/sizes-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { LiquidGlassButton } from \"./liquid-glass-button\";\r\nimport { LogOut, Search, Heart } from \"lucide-react\";\r\n\r\nexport function LiquidGlassSizesDemo() {\r\n  return (\r\n    <div className=\"flex flex-wrap gap-4 items-center justify-center min-h-[200px] p-8\">\r\n      <LiquidGlassButton size=\"sm\">Small</LiquidGlassButton>\r\n      <LiquidGlassButton size=\"default\">Default</LiquidGlassButton>\r\n      <LiquidGlassButton size=\"lg\">Large</LiquidGlassButton>\r\n      <LiquidGlassButton>\r\n        <LogOut className=\"size-4\" />\r\n        Logout\r\n      </LiquidGlassButton>\r\n      <LiquidGlassButton size=\"icon\">\r\n        <Search className=\"size-4\" />\r\n      </LiquidGlassButton>\r\n      <LiquidGlassButton size=\"lg\">\r\n        <Heart className=\"size-4\" />\r\n        Like\r\n      </LiquidGlassButton>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/components/liquid-glass-button/colors-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { LiquidGlassButton } from \"./liquid-glass-button\";\r\n\r\nexport function LiquidGlassColorsDemo() {\r\n  return (\r\n    <div className=\"flex flex-wrap gap-4 items-center justify-center min-h-[200px] p-8\">\r\n      <LiquidGlassButton textClassName=\"text-blue-500\">\r\n        Blue Text\r\n      </LiquidGlassButton>\r\n      <LiquidGlassButton textClassName=\"text-green-500\">\r\n        Green Text\r\n      </LiquidGlassButton>\r\n      <LiquidGlassButton textClassName=\"text-purple-500\">\r\n        Purple Text\r\n      </LiquidGlassButton>\r\n      <LiquidGlassButton textClassName=\"text-white mix-blend-difference\">\r\n        Inverted\r\n      </LiquidGlassButton>\r\n      <LiquidGlassButton textClassName=\"text-black font-bold\">\r\n        Bold Black\r\n      </LiquidGlassButton>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/components/liquid-glass-button/advanced-liquid-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { LiquidGlassButton } from \"./liquid-glass-button\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\n\r\nexport function LiquidGlassAdvancedDemo() {\r\n  const [distortionStrength, setDistortionStrength] = useState(0.15);\r\n  const [borderRadius, setBorderRadius] = useState(0.6);\r\n  const [animationSpeed, setAnimationSpeed] = useState(1);\r\n  const [scale, setScale] = useState(1);\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center gap-8 min-h-[400px] p-8\">\r\n      {/* Demo Button */}\r\n      <LiquidGlassButton\r\n        distortionStrength={distortionStrength}\r\n        borderRadius={borderRadius}\r\n        animationSpeed={animationSpeed}\r\n        scale={scale}\r\n        textClassName=\"text-white\"\r\n      >\r\n        Advanced Control\r\n      </LiquidGlassButton>\r\n\r\n      {/* Controls */}\r\n      <div className=\"w-full max-w-2xl space-y-6\">\r\n        <div className=\"space-y-2\">\r\n          <label htmlFor=\"distortion\" className=\"text-sm font-medium\">\r\n            Distortion Strength: {distortionStrength.toFixed(2)}\r\n          </label>\r\n          <Slider\r\n            id=\"distortion\"\r\n            min={0.05}\r\n            max={0.3}\r\n            step={0.01}\r\n            value={[distortionStrength]}\r\n            onValueChange={(value) => setDistortionStrength(value[0])}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <label htmlFor=\"border\" className=\"text-sm font-medium\">\r\n            Border Radius: {borderRadius.toFixed(2)}\r\n          </label>\r\n          <Slider\r\n            id=\"border\"\r\n            min={0.3}\r\n            max={1.5}\r\n            step={0.01}\r\n            value={[borderRadius]}\r\n            onValueChange={(value) => setBorderRadius(value[0])}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <label htmlFor=\"speed\" className=\"text-sm font-medium\">\r\n            Animation Speed: {animationSpeed.toFixed(2)}\r\n          </label>\r\n          <Slider\r\n            id=\"speed\"\r\n            min={0.1}\r\n            max={3}\r\n            step={0.1}\r\n            value={[animationSpeed]}\r\n            onValueChange={(value) => setAnimationSpeed(value[0])}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          <label htmlFor=\"scale\" className=\"text-sm font-medium\">\r\n            Scale: {scale.toFixed(2)}\r\n          </label>\r\n          <Slider\r\n            id=\"scale\"\r\n            min={0.5}\r\n            max={2}\r\n            step={0.1}\r\n            value={[scale]}\r\n            onValueChange={(value) => setScale(value[0])}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    }
  ]
}
